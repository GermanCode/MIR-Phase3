{"id":51956659,"title":"The No-U-Turn Sampler: Adaptively Setting Path Lengths in Hamiltonian Monte Carlo","authors":["Matthew D. Hoffman","Andrew Gelman"],"_abstract":"Hamiltonian Monte Carlo (HMC) is a Markov chain Monte Carlo (MCMC) algorithm that avoids the random walk behavior and sensitivity to correlated parameters that plague many MCMC methods by taking a series of steps informed by first-order gradient information. These features allow it to converge to high-dimensional target distributions much more quickly than simpler methods such as random walk Metropolis or Gibbs sampling. However, HMC's performance is highly sensitive to two user-specified parameters: a step size {\\epsilon} and a desired number of steps L. In particular, if L is too small then the algorithm exhibits undesirable random walk behavior, while if L is too large the algorithm wastes computation. We introduce the No-U-Turn Sampler (NUTS), an extension to HMC that eliminates the need to set a number of steps L. NUTS uses a recursive algorithm to build a set of likely candidate points that spans a wide swath of the target distribution, stopping automatically when it starts to double back and retrace its steps. Empirically, NUTS perform at least as efficiently as and sometimes more efficiently than a well tuned standard HMC method, without requiring user intervention or costly tuning runs. We also derive a method for adapting the step size parameter {\\epsilon} on the fly based on primal-dual averaging. NUTS can thus be used with no hand-tuning at all. NUTS is also suitable for applications such as BUGS-style automatic inference engines that require efficient \"turnkey\" sampling algorithms.","cited_in":[{"id":291075457,"url":"https://www.researchgate.net/publication/291075457_Increasing_the_accuracy_and_temporal_resolution_of_two-filter_radon-222_measurements_by_correcting_for_the_instrument_response"},{"id":284579096,"url":"https://www.researchgate.net/publication/284579096_Recycling_intermediate_steps_to_improve_Hamiltonian_Monte_Carlo"},{"id":283334566,"url":"https://www.researchgate.net/publication/283334566_Competition_among_eggs_shifts_to_cooperation_along_a_sperm_supply_gradient_in_an_external_fertilizer"},{"id":283043210,"url":"https://www.researchgate.net/publication/283043210_A_General_Method_for_Robust_Bayesian_Modeling"},{"id":281145119,"url":"https://www.researchgate.net/publication/281145119_Non-Stationary_Gaussian_Process_Regression_with_Hamiltonian_Monte_Carlo"},{"id":280773011,"url":"https://www.researchgate.net/publication/280773011_Adaptive_Multiple_Importance_Sampling_for_Gaussian_Processes"},{"id":275897326,"url":"https://www.researchgate.net/publication/275897326_A_Survey_of_Stochastic_Simulation_and_Optimization_Methods_in_Signal_Processing"},{"id":272027312,"url":"https://www.researchgate.net/publication/272027312_Stochastic_Newton_Sampler_R_Package_sns"},{"id":270222674,"url":"https://www.researchgate.net/publication/270222674_Multivariate-from-Univariate_MCMC_Sampler_R_Package_MfUSampler"},{"id":264385539,"url":"https://www.researchgate.net/publication/264385539_Extra_Chance_Hybrid_Monte_Carlo"},{"id":258373948,"url":"https://www.researchgate.net/publication/258373948_Auxiliary-variable_Exact_Hamiltonian_Monte_Carlo_Samplers_for_Binary_Distributions"},{"id":230706405,"url":"https://www.researchgate.net/publication/230706405_Exact_Hamiltonian_Monte_Carlo_for_Truncated_Multivariate_Gaussians"},{"id":265317902,"url":"https://www.researchgate.net/publication/265317902_Markov_Chain_Monte_Carlo_and_Numerical_Differential_Equations"},{"id":51914081,"url":"https://www.researchgate.net/publication/51914081_Split_Hamiltonian_Monte_Carlo"},{"id":232743848,"url":"https://www.researchgate.net/publication/232743848_Laplace_Approximation_for_Logistic_Gaussian_Process_Density_Estimation_and_Regression"},{"id":233426925,"url":"https://www.researchgate.net/publication/233426925_Lagrangian_Dynamical_Monte_Carlo"},{"id":233937258,"url":"https://www.researchgate.net/publication/233937258_A_General_Metric_for_Riemannian_Manifold_Hamiltonian_Monte_Carlo"},{"id":259171545,"url":"https://www.researchgate.net/publication/259171545_Hierarchical_second-order_analysis_of_replicated_spatial_point_patterns_with_non-spatial_covariates"},{"id":235216606,"url":"https://www.researchgate.net/publication/235216606_Geodesic_Monte_Carlo_on_Embedded_Manifolds"},{"id":235703008,"url":"https://www.researchgate.net/publication/235703008_Adaptive_Hamiltonian_and_Riemann_Manifold_Monte_Carlo_Samplers"},{"id":236037622,"url":"https://www.researchgate.net/publication/236037622_Spatial_and_spatio-temporal_models_with_R-INLA"},{"id":236124515,"url":"https://www.researchgate.net/publication/236124515_Generalizing_the_No-U-Turn_Sampler_to_Riemannian_Manifolds"},{"id":237842979,"url":"https://www.researchgate.net/publication/237842979_Bayesian_State-Space_Modelling_on_High-Performance_Hardware_Using_LibBi"},{"id":262316713,"url":"https://www.researchgate.net/publication/262316713_Active_learning_and_search_on_low-rank_matrices"},{"id":256465121,"url":"https://www.researchgate.net/publication/256465121_Bayesian_Nonparametric_Weighted_Sampling_Inference"},{"id":257618460,"url":"https://www.researchgate.net/publication/257618460_A_comparative_evaluation_of_stochastic-based_inference_methods_for_Gaussian_process_models"},{"id":258247474,"url":"https://www.researchgate.net/publication/258247474_Discussion_of_Geodesic_Monte_Carlo_on_Embedded_Manifolds"},{"id":258631741,"url":"https://www.researchgate.net/publication/258631741_Asymptotically_Exact_Embarrassingly_Parallel_MCMC"},{"id":259155506,"url":"https://www.researchgate.net/publication/259155506_Characterization_of_Field_Loss_Based_on_Microperimetry_Is_Predictive_of_Face_Recognition_Difficulties"},{"id":259653355,"url":"https://www.researchgate.net/publication/259653355_Validating_the_PVL-Delta_model_for_the_Iowa_gambling_task"},{"id":259919851,"url":"https://www.researchgate.net/publication/259919851_Ecoinformatics_Reveals_Effects_of_Crop_Rotational_Histories_on_Cotton_Yield"},{"id":262046424,"url":"https://www.researchgate.net/publication/262046424_Comprehensive_Functional_Annotation_of_77_Prostate_Cancer_Risk_Loci"},{"id":260003754,"url":"https://www.researchgate.net/publication/260003754_Scalable_Rejection_Sampling_for_Bayesian_Hierarchical_Models"},{"id":263593993,"url":"https://www.researchgate.net/publication/263593993_Contribution_to_the_Discussion_of_the_Paper_Geodesic_Monte_Carlo_on_Embedded_Manifolds"},{"id":261190308,"url":"https://www.researchgate.net/publication/261190308_Uncertainty_priors_autocorrelation_and_disparate_data_in_downscaling_of_species_distributions"},{"id":264193003,"url":"https://www.researchgate.net/publication/264193003_Bayesian_Inference_of_Deterministic_Population_Growth_Models"},{"id":260873385,"url":"https://www.researchgate.net/publication/260873385_A_reversible_infinite_HMM_using_normalised_random_measures"},{"id":261959273,"url":"https://www.researchgate.net/publication/261959273_CoBaFi_-_Collaborative_Bayesian_filtering"},{"id":261635890,"url":"https://www.researchgate.net/publication/261635890_Unsupervised_Transient_Light_Curve_Analysis_Via_Hierarchical_Bayesian_Inference"},{"id":263163577,"url":"https://www.researchgate.net/publication/263163577_Semi-Separable_Hamiltonian_Monte_Carlo_for_Inference_in_Bayesian_Hierarchical_Models"},{"id":265383896,"url":"https://www.researchgate.net/publication/265383896_How_variable_is_recruitment_for_exploited_marine_fishes_A_hierarchical_model_for_testing_life_history_theory"},{"id":269722960,"url":"https://www.researchgate.net/publication/269722960_A_hierarchical_zero-inflated_model_for_species_compositional_data-from_individual_taxon_responses_to_community_response"},{"id":264197574,"url":"https://www.researchgate.net/publication/264197574_Frequency_behaviour_for_multinomial_counts_of_fisheries_discards_via_a_nested_wavelet_zero_and_N_inflated_binomial_model"},{"id":267287786,"url":"https://www.researchgate.net/publication/267287786_Hierarchical_Bayesian_analysis_to_measure_differences_in_stock-recruitment_parameters_across_harvested_fish_taxa"},{"id":263812303,"url":"https://www.researchgate.net/publication/263812303_Real_driving_at_night_-_Predicting_lane_departures_from_physiological_and_subjective_sleepiness"},{"id":264124643,"url":"https://www.researchgate.net/publication/264124643_Applications_of_Bayesian_Methods_to_Epidemiologic_Research"},{"id":265794725,"url":"https://www.researchgate.net/publication/265794725_A_Fully_Bayesian_Inference_Framework_for_Population_Studies_of_the_Brain_Microstructure"},{"id":265794541,"url":"https://www.researchgate.net/publication/265794541_Four_Neuroimaging_Questions_that_P-Values_Cannot_Answer_and_Bayesian_Analysis_Can"},{"id":267275902,"url":"https://www.researchgate.net/publication/267275902_Function_regression_in_ecology_and_evolution_FREE"},{"id":267157208,"url":"https://www.researchgate.net/publication/267157208_The_Geometric_Foundations_of_Hamiltonian_Monte_Carlo"},{"id":268525866,"url":"https://www.researchgate.net/publication/268525866_Regional_frequency_analysis_conditioned_on_large-scale_atmospheric_or_oceanic_fields"},{"id":269722654,"url":"https://www.researchgate.net/publication/269722654_Transport_map_accelerated_Markov_chain_Monte_Carlo"},{"id":266378694,"url":"https://www.researchgate.net/publication/266378694_Bayesian_approach_for_flexible_modeling_of_semicompeting_risks_data"},{"id":275348086,"url":"https://www.researchgate.net/publication/275348086_Spatial_and_Spatio-temporal_Bayesian_Models_with_R_-_INLA"},{"id":275644741,"url":"https://www.researchgate.net/publication/275644741_Superstatistical_analysis_and_modeling_of_heterogeneous_random_walks"},{"id":280091481,"url":"https://www.researchgate.net/publication/280091481_A_hierarchical_Bayesian_analysis_of_parasite_prevalence_and_sociocultural_outcomes_The_role_of_structural_racism_and_sanitation_infrastructure"},{"id":283877058,"url":"https://www.researchgate.net/publication/283877058_Constraining_Cognitive_Abstractions_Through_Bayesian_Modeling"},{"id":283095581,"url":"https://www.researchgate.net/publication/283095581_MPME-DP_Multi-population_moment_estimation_via_dirichlet_process_for_efficient_validation_of_analogmixed-signal_circuits"},{"id":271388277,"url":"https://www.researchgate.net/publication/271388277_Generalized_multilevel_function-on-scalar_regression_and_principal_component_analysis"},{"id":272187251,"url":"https://www.researchgate.net/publication/272187251_Inducible_Nitric_Oxide_Synthase_iNOS_Regulatory_Region_Variation_in_Non-Human_Primates"},{"id":273702834,"url":"https://www.researchgate.net/publication/273702834_Chromosomal_damage_and_EROD_induction_in_tree_swallows_Tachycineta_bicolor_along_the_Upper_Mississippi_River_Minnesota_USA"},{"id":275102893,"url":"https://www.researchgate.net/publication/275102893_Spatial_and_temporal_variation_in_harvest_probabilities_for_American_black_duck"},{"id":274730652,"url":"https://www.researchgate.net/publication/274730652_Precomputing_Strategy_for_Hamiltonian_Monte_Carlo_Method_Based_on_Regularity_in_Parameter_Space"},{"id":275364485,"url":"https://www.researchgate.net/publication/275364485_Random_projections_for_Bayesian_regression"},{"id":275520025,"url":"https://www.researchgate.net/publication/275520025_Characterization_of_Burkholderia_pseudomallei_Strains_Using_a_Murine_Intraperitoneal_Infection_Model_and_In_Vitro_Macrophage_Assays"},{"id":276134152,"url":"https://www.researchgate.net/publication/276134152_Quantifying_Geographic_Variation_in_the_Climatic_Drivers_of_Midcontinent_Wetlands_with_a_Spatially_Varying_Coefficient_Model"},{"id":280972213,"url":"https://www.researchgate.net/publication/280972213_Generating_Design_Suggestions_under_Tight_Constraints_with_Gradient-based_Probabilistic_Programming"},{"id":274095858,"url":"https://www.researchgate.net/publication/274095858_Predictive_statistical_models_linking_antecedent_meteorological_conditions_and_waterway_bacterial_contamination_in_urban_waterways"},{"id":279195788,"url":"https://www.researchgate.net/publication/279195788_Superstatistical_analysis_and_modelling_of_heterogeneous_random_walks"},{"id":278046059,"url":"https://www.researchgate.net/publication/278046059_Sensitivity_to_gaze-contingent_contrast_increments_in_naturalistic_movies_An_exploratory_report_and_model_comparison"},{"id":279232103,"url":"https://www.researchgate.net/publication/279232103_Context_influences_on_TALE-DNA_binding_revealed_by_quantitative_profiling"},{"id":278332201,"url":"https://www.researchgate.net/publication/278332201_Stochastic_Expectation_Propagation"},{"id":279194119,"url":"https://www.researchgate.net/publication/279194119_Hype_and_Heavy_Tails_A_Closer_Look_at_Data_Breaches"},{"id":279458785,"url":"https://www.researchgate.net/publication/279458785_Gaussian_Process_Regression_with_Location_Errors"},{"id":279458734,"url":"https://www.researchgate.net/publication/279458734_Leave_Pima_Indians_alone_binary_regression_as_a_benchmark_for_Bayesian_computation"},{"id":282271560,"url":"https://www.researchgate.net/publication/282271560_A_new_probabilistic_constraint_logic_programming_language_based_on_a_generalised_distribution_semantics"},{"id":280330280,"url":"https://www.researchgate.net/publication/280330280_Gradient_Importance_Sampling"},{"id":280329794,"url":"https://www.researchgate.net/publication/280329794_Emulation_of_Higher-Order_Tensors_in_Manifold_Monte_Carlo_Methods_for_Bayesian_Inverse_Problems"},{"id":280496847,"url":"https://www.researchgate.net/publication/280496847_Gradient-based_MCMC_samplers_for_Dynamic_Causal_Modelling"},{"id":280911682,"url":"https://www.researchgate.net/publication/280911682_Multicohort_analysis_of_the_maternal_age_effect_on_recombination"},{"id":281171843,"url":"https://www.researchgate.net/publication/281171843_Augmented_Beta_rectangular_regression_models_A_Bayesian_perspective"},{"id":281204327,"url":"https://www.researchgate.net/publication/281204327_Hierarchical_Bayesian_clustering_for_nonstationary_flood_frequency_analysis_Application_to_trends_of_annual_maximum_flow_in_Germany"},{"id":281373764,"url":"https://www.researchgate.net/publication/281373764_Almaraz_2015_-_Clim_Res_-_Supp_Mat"},{"id":273400271,"url":"https://www.researchgate.net/publication/273400271_SIMD_parallel_MCMC_sampling_with_applications_for_big-data_Bayesian_analytics"},{"id":281896857,"url":"https://www.researchgate.net/publication/281896857_The_Dynamics_of_State_Policy_Liberalism_1936-2014"},{"id":281820109,"url":"https://www.researchgate.net/publication/281820109_A_Bayesian_Modelling_of_Wildfires_in_Portugal"},{"id":282295155,"url":"https://www.researchgate.net/publication/282295155_Variational_methods_for_fitting_complex_Bayesian_mixed_effects_models_to_health_data"},{"id":282691831,"url":"https://www.researchgate.net/publication/282691831_The_Bouncy_Particle_Sampler_A_Non-Reversible_Rejection-Free_Markov_Chain_Monte_Carlo_Method"},{"id":283785717,"url":"https://www.researchgate.net/publication/283785717_Stan_A_Probabilistic_Programming_Language_for_Bayesian_Inference_and_Optimization"},{"id":282181456,"url":"https://www.researchgate.net/publication/282181456_Bayesian_inference_on_the_sphere_beyond_statistical_isotropy"},{"id":283976875,"url":"https://www.researchgate.net/publication/283976875_Assessing_the_spatial_variability_of_density_dependence_in_waterfowl_populations"},{"id":283545109,"url":"https://www.researchgate.net/publication/283545109_Short_and_Long-Term_Soil_Moisture_Effects_of_Liana_Removal_in_a_Seasonally_Moist_Tropical_Forest"},{"id":284219359,"url":"https://www.researchgate.net/publication/284219359_A_Bayesian_Semiparametric_Framework_for_Understanding_and_Predicting_Customer_Base_Dynamics"},{"id":285458733,"url":"https://www.researchgate.net/publication/285458733_Randomized_Hamiltonian_Monte_Carlo"},{"id":287405758,"url":"https://www.researchgate.net/publication/287405758_Hamiltonian_Monte_Carlo_and_Borrowing_Strength_in_Hierarchical_Inverse_Problems"},{"id":291011122,"url":"https://www.researchgate.net/publication/291011122_SPOTting_Model_Parameters_Using_a_Ready-Made_Python_Package"},{"id":288664633,"url":"https://www.researchgate.net/publication/288664633_The_representational_consequences_of_intentional_forgetting_Impairments_to_both_the_probability_and_fidelity_of_long-term_memory"},{"id":289587906,"url":"https://www.researchgate.net/publication/289587906_Variational_Inference_A_Review_for_Statisticians"},{"id":290429577,"url":"https://www.researchgate.net/publication/290429577_Adaptive_Step_Size_Selection_for_Hessian-Based_Manifold_Langevin_Samplers"}],"reference":["https://www.researchgate.net/publication/200175478_Simulating_Hamiltonian_Dynamics","https://www.researchgate.net/publication/222018937_Hybrid_Monte_Carlo","https://www.researchgate.net/publication/45897328_Optimal_tuning_of_the_Hybrid_Monte-Carlo_Algorithm","https://www.researchgate.net/publication/12826203_Some_adaptive_Monte_Carlo_methods_for_Bayesian_inference","https://www.researchgate.net/publication/1990414_An_Improved_Acceptance_Procedure_for_the_Hybrid_Monte_Carlo_Algorithm","https://www.researchgate.net/publication/13330566_Global_Monte_Carlo_algorithms_for_many-fermion_systems","https://www.researchgate.net/publication/49458431_A_tutorial_on_adaptive_MCMC","https://www.researchgate.net/publication/265369049_Slice_sampling_With_discussions_and_rejoinder","https://www.researchgate.net/publication/236736791_A_Stochastic_Approximation_Method","https://www.researchgate.net/publication/227657870_Riemann_manifold_Langevin_and_Hamiltonian_Monte_Carlo_methods_J_R_Stat_Soc_B_73_123-214","https://www.researchgate.net/publication/220416605_Graphical_Models_Exponential_Families_and_Variational_Inference","https://www.researchgate.net/publication/225657227_Primal-dual_Subgradient_Methods_for_Convex_Problems","https://www.researchgate.net/publication/220695124_Evaluating_Derivatives_Principles_and_Techniques_of_Algorithmic_Differentiation","https://www.researchgate.net/publication/200105001_Equation_of_State_by_Fast_Computing_Machines"]}